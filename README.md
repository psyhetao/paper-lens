# paper-lens 🔍

> 智能文献分析与标注工具 - OpenCode 专属技能

`paper-lens` 旨在将您的文献阅读过程从「被动接收」转变为「主动洞察」。它通过了解您的研究背景，为您生成极具针对性的分析笔记，并在原 PDF 上进行分类标注。

## ✨ 功能亮点

- **个性化档案**：记住您的研究领域，分析更懂你。
- **意图感知**：根据「随便看看」或「深研方法」自动调整分析深度。
- **六色标注**：在 PDF 上自动高亮核心结论、方法、疑问等。
- **APA 引用**：自动生成标准学术引用。
- **双重输出**：同目录下生成 `.md` 笔记与 `_note.pdf`（带高亮和注释）。
- **极速提取**：使用 pypdfium2，比传统方法快 3 倍。
- **智能注释**：基于关键词自动生成文本注释。
- **图文结合**：笔记中自动插入相关页面图像。

## 📋 安装要求

- Python 3.8+
- Python 库：
  - `pymupdf>=1.23.0` - PDF 处理
  - `pdfplumber>=0.10.0` - 文本提取
  - `pypdfium2>=4.30.0` - 高效文本提取和图像渲染
  - `Pillow>=10.0.0` - 图像处理

## 🚀 快速上手

1. **安装依赖**：
   ```bash
   pip install pymupdf>=1.23.0 pdfplumber>=0.10.0 pypdfium2>=4.30.0 Pillow>=10.0.0
   ```
   
   或直接安装 REQUIREMENTS.txt：
   ```bash
   pip install -r REQUIREMENTS.txt
   ```

2. **安装技能**：
   将此文件夹放入 `~/.config/opencode/skills/paper-lens`

3. **重启 OpenCode**

4. **开始使用**：
   对我说：`分析文献 [PDF路径]`

## 🎨 标注颜色规范

| 颜色 | 含义 | 说明 |
|------|------|------|
| 🟡 **黄色** | 核心结论 | 文章的主要发现和结论 |
| 🟢 **绿色** | 方法/技术 | 实验方法、技术路线、数据分析方法 |
| 🔵 **蓝色** | 与我研究相关 | 与用户研究兴趣直接相关的内容 |
| 🔴 **红色** | 存疑/需验证 | 疑问、局限、需要进一步验证的地方 |
| 🟣 **紫色** | 可直接引用段落 | 写得很好、可以直接引用的原文 |
| 🟠 **橙色** | 背景/基础知识 | 背景知识、基础概念 |

## 🔧 技术特性

### 文本提取优化
- **pypdfium2 引擎**：比 pdfplumber 快 3 倍
- **高质量图像渲染**：支持将 PDF 页面渲染为高清图像
- **兼容接口**：保持原有 API，返回格式不变

### PDF 标注增强
- **自动文本注释**：基于关键词自动生成注释
- **双模式注释**：支持高亮注释和文本便签
- **命名规范**：输出文件为 `[原文件名]_note.pdf`

### 笔记模板升级
- **自动图片插入**：在核心内容分析部分后插入相关页面图像
- **结构化输出**：研究问题 → 方法论 → 关键结论 → 全文亮点

## 📁 文件说明

```
paper-lens/
├── SKILL.md              # 技能定义文件（OpenCode 使用）
├── README.md             # 本文件
├── REQUIREMENTS.txt      # Python 依赖
├── prompts/              # 提示词模板
│   ├── profile-questions.md    # 研究档案问题
│   └── purpose-options.md      # 阅读目的选项
├── scripts/              # 核心脚本
│   ├── extract_quotes.py       # 文本提取
│   ├── annotate_pdf.py         # PDF 标注
│   └── setup_check.py          # 环境检查
└── templates/            # 笔记模板
    └── note-full.md            # 完整笔记模板
```

## 📝 使用示例

```
用户：分析文献 ~/Downloads/paper.pdf

OpenCode：
1. 检查研究档案... ✓
2. 询问阅读目的... [方法学习]
3. 提取文献内容...
4. 生成分析笔记... ✓ 保存为 paper_notes.md
5. 执行 PDF 标注... ✓ 保存为 paper_note.pdf
6. 完成！发现 3 个方法论创新点。
```

## 👨‍💻 开发者

由 **Psyhetao** 为研究者精心打造。

---

**版本**: 0.1.0 | **GitHub**: https://github.com/psyhetao/paper-lens
